<% unless @products.nil? %>
  <h2>Filter Results</h2>
  <%= form_tag filter_products_path, method: :get do %>
    <%= label_tag :category, "Category" %>
    <%= select_tag :category, options_for_select(Category.pluck(:items, :id)), {include_blank: true, class: 'category-select' } %>
    <%= label_tag :sub_category, "Sub Category" %>
    <%= select_tag :sub_category, options_for_select([]), {include_blank: true, class: 'subcategory-select' } %>
    <%= text_field_tag :location, params[:location], placeholder: "Enter location" %>
    <%= submit_tag "Filter" %>
  <% end %>
  <% begin %>
    <% if @products.empty? %>
      <h1>No posts found matching your query.</h1>
    <% else %>
      <h1>Search results</h1>
      <div class="d-flex flex-wrap">
        <% @products.each do |prod| %>
          <%= render partial: 'welcomes/item_card', locals: { item: prod } %>
        <% end %>
      </div>
      <%= paginate @products %>
    <% end %>
    <% rescue %>
    <h1>No posts found matching your query.</h1>
  <% end %>
<% end %>
